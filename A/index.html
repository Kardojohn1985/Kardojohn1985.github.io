<!DOCTYPE html>
<html ng-app="custom-webapp-ui" lang="fa">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
    <!-- Load the Telegram Library -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Load the AngularJS Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script>
      angular.module("custom-webapp-ui", []).controller('CustomUIController', function CustomUIController($scope) {
        // Define sections
        $scope.sections = [
          {
            title: "کباب کوبیده",
            items: [
              { name: "کوبیده تک سیخ ۹۹۰۰۰", value: 0 },
              { name: "کوبیده دو‌ سیخ ۱۹۹۰۰۰", value: 0 },
              { name: "چلوکوبیده تک سیخ ۱۶۵۰۰۰", value: 0 },
              { name: "چلوکوبیده مخصوص ۳۳۹۰۰۰", value: 0 }
            ],
            image: "a.jpeg"
          },
          {
            title: "مرغ و غذاهای دریایی",
            items: [
              { name: "جوجه کباب ۱۵۰۰۰۰", value: 0 },
              { name: "ماهی قزل‌آلا ۲۳۰۰۰۰", value: 0 }
            ],
            image: "c.jpg"
          }
        ];

        // Telegram MainButton functionality
        const mainButton = window.Telegram.WebApp.MainButton;
        mainButton.text = "ثبت سفارش و بازگشت به منوی اصلی";
        mainButton.fontsize = "50px";
        mainButton.enable();
        mainButton.show();
        mainButton.onClick(function () {
          window.Telegram.WebApp.sendData(JSON.stringify($scope.sections));
        });

        // Functions to increase or decrease item values
        $scope.increaseValue = function (item) {
          if (item.value < 50) {
            item.value++;
          }
        };

        $scope.decreaseValue = function (item) {
          if (item.value > 0) {
            item.value--;
          }
        };
      });

      // Hide text on scroll
      window.addEventListener('scroll', function () {
        const scrollText = document.getElementById('scroll-text');
        if (window.scrollY > 0) {
          scrollText.style.display = 'none';
        } else {
          scrollText.style.display = 'block';
        }
      });
    </script>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        overflow-y: auto; /* Enable scrolling */
        background: url('images/b.jpg') no-repeat center center fixed;
        background-size: cover; /* Make the image cover the entire page */
      }

      .page-title {
        font-weight: bold;
        color: teal;
        text-align: center;
        margin-top: 2rem;
        margin-bottom: 2rem;
        font-size: 3rem;
      }

      .top-text {
        position: absolute;
        top: 10px;
        right: 10px; /* Adjust for left corner if desired */
        color: white;
        font-size: 1rem; /* Smaller font */
        font-weight: bold;
        background: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
        padding: 5px 10px;
        border-radius: 5px;
        z-index: 1000; /* Ensure it stays above other content */
        transition: opacity 0.3s ease; /* Smoothly hide */
      }

      .image-container {
        text-align: center;
        margin-top: 2rem;
        margin-bottom: 2rem;
      }

      .image-container img {
        max-width: 100%;
        height: auto;
      }

      .food-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
        padding: 0 1rem;
      }

      .food-name {
        font-size: 2rem;
        font-weight: bold;
        color: black;
        flex-grow: 1;
      }

      .food-value {
        color: black;
        font-size: 1.6rem;
        font-weight: bold;
        margin-right: 1rem;
      }

      .btn {
        font-weight: bold;
        font-size: 1.5rem;
        width: 2rem;
        height: 2rem;
        text-align: center;
        line-height: 1.7rem;
        border: none;
        background-color: #FFFDD0;
        color: black;
        margin: 0;
        padding: 0;
        margin-right: 3vw;
        border-radius: 0.5rem;
      }

      .btn-decrease {
        margin-right: 0.5rem;
      }

      /* Force content height for scrolling */
      .scroll-test {
        height: 150vh; /* Add extra height to test scrolling */
      }

      @media (max-width: 600px) {
        .food-name {
          font-size: 1.1rem;
        }

        .food-value {
          font-size: 1.4rem;
        }

        .btn {
          font-size: 1.5rem;
          width: 2.1rem;
          height: 2.1rem;
          line-height: 1.3rem;
        }
      }
    </style>
  </head>
  <body ng-controller="CustomUIController">
    <!-- Top Corner Text -->
    <div id="scroll-text" class="top-text">صفحه را بکشید پایین</div>

    <div ng-repeat="section in sections">
      <h2 class="page-title">{{section.title}}</h2>
      <div ng-repeat="item in section.items" class="food-item">
        <span class="food-name">{{item.name}} :</span>
        <span class="food-value">{{item.value}}</span>
        <button class="btn btn-decrease" ng-click="decreaseValue(item)">-</button>
        <button class="btn" ng-click="increaseValue(item)">+</button>
      </div>
      <div class="image-container">
        <img ng-src="{{section.image}}" alt="{{section.title}}">
      </div>
    </div>

    <!-- Test scroll area -->
    <div class="scroll-test"></div>
  </body>
</html>
